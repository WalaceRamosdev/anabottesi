---

---

<section
    id="depoimentos"
    aria-labelledby="titulo-depoimentos"
    class="bg-brand-bg/50 py-24 md:py-40 overflow-hidden relative"
>
    <!-- Efeito de Borboletas Intenso (Espinha Dorsal do Site) -->
    <div
        class="absolute inset-0 pointer-events-none overflow-hidden"
        id="testimonials-butterfly-container"
    >
    </div>

    <div class="max-w-4xl mx-auto px-4 md:px-8 relative z-10">
        <div class="text-center mb-12 md:mb-16 relative">
            <h2
                id="titulo-depoimentos"
                class="text-7xl md:text-9xl font-handwriting text-brand-accent relative z-10 mb-2"
            >
                Depoimentos
            </h2>

            <!-- Divisor Floral Premium Unificado (Sem separação nas juntas) -->
            <div class="flex justify-center -mt-6 opacity-90">
                <svg
                    width="280"
                    height="60"
                    viewBox="0 0 280 60"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="text-brand-primary drop-shadow-sm overflow-visible"
                >
                    <!-- Grupo Principal de Flutuação (Mantém tudo unido) -->
                    <g class="animate-float-slow">
                        <!-- Linhas Curvas Laterais (Asas) - Unidas no centro da base (140, 58) -->
                        <g class="animate-wing-left">
                            <path
                                d="M10 53C50 53 80 33 140 60"
                                stroke="currentColor"
                                stroke-width="1.8"
                                stroke-linecap="round"
                                fill="none"></path>
                            <circle cx="55" cy="43" r="2.5" fill="currentColor"
                            ></circle>
                            <circle cx="95" cy="35" r="1.5" fill="currentColor"
                            ></circle>
                        </g>

                        <g class="animate-wing-right">
                            <path
                                d="M140 60C200 33 230 53 270 53"
                                stroke="currentColor"
                                stroke-width="1.8"
                                stroke-linecap="round"
                                fill="none"></path>
                            <circle cx="185" cy="35" r="1.5" fill="currentColor"
                            ></circle>
                            <circle cx="225" cy="43" r="2.5" fill="currentColor"
                            ></circle>
                        </g>

                        <!-- Elemento Floral Central (Lótus de 5 Pétalas) -->
                        <g
                            transform="translate(140, 52) scale(0.8) translate(-25,-50)"
                        >
                            <path
                                d="M25 50C25 50 15 35 15 25C15 15 25 10 25 10C25 10 35 15 35 25C35 35 25 50 25 50Z"
                                fill="currentColor"></path>
                            <path
                                d="M25 50C25 50 5 45 0 35C-5 25 5 15 5 15C5 15 15 20 20 30C25 40 25 50 25 50Z"
                                fill="currentColor"></path>
                            <path
                                d="M25 50C25 50 45 45 50 35C55 25 45 15 45 15C45 15 35 20 30 30C25 40 25 50 25 50Z"
                                fill="currentColor"></path>
                            <path
                                d="M25 50C25 50 -5 55 -15 50C-25 45 -20 35 -20 35C-20 35 -10 35 0 42C10 49 25 50 25 50Z"
                                fill="currentColor"></path>
                            <path
                                d="M25 50C25 50 55 55 65 50C75 45 70 35 70 35C70 35 60 35 50 42C40 49 25 50 25 50Z"
                                fill="currentColor"></path>
                        </g>
                    </g>
                </svg>
            </div>
        </div>
    </div>
</section>

<div class="testimonial-main-container">
    <!-- Depoimento Pilar (Single/Principal) -->
    <blockquote
        class="testimonial-pilar bg-white p-10 md:p-20 rounded-[32px] border border-brand-primary/10 shadow-2xl relative group overflow-hidden"
    >
        <!-- Aspas Gigantes Decorativas -->
        <div
            class="absolute -top-6 -left-2 text-[200px] font-serif text-brand-primary/5 leading-none select-none pointer-events-none"
        >
            “
        </div>

        <div class="space-y-6 md:space-y-8 relative z-10">
            <p
                class="text-brand-text/90 text-xl md:text-3xl leading-[1.6] md:leading-[1.5] font-medium"
            >
                "Poderia começar dizendo tantas coisas, mas o resumo é simples:
                o trabalho da Ana salvou a minha vida."
            </p>
            <p class="text-brand-text/80 text-lg md:text-2xl leading-[1.6]">
                Hoje sou uma mulher feliz, com autonomia, e nunca estive tão
                bem.
            </p>
            <p class="text-brand-text/80 text-lg md:text-2xl leading-[1.6]">
                A Ana é gentil, profissional, agradável e, acima de tudo, <span
                    class="text-brand-primary font-bold">humana</span
                >.
            </p>
            <p
                class="text-brand-text/90 text-xl md:text-2xl font-bold italic pt-4"
            >
                "Não troco o trabalho dela por absolutamente nada."
            </p>
        </div>

        <footer
            class="flex flex-col md:flex-row md:items-center justify-between gap-4 border-t border-brand-primary/10 mt-12 pt-8 relative z-10"
        >
            <div class="flex items-center gap-4">
                <div
                    class="w-12 h-12 bg-brand-secondary/20 rounded-full flex items-center justify-center text-xl"
                >
                    <i class="fa-solid fa-quote-left text-brand-primary/60"></i>
                </div>
                <div>
                    <span
                        class="author font-serif text-brand-primary font-bold text-xl block"
                        >L.S.</span
                    >
                    <span
                        class="text-xs text-brand-text/40 uppercase tracking-widest"
                        >Paciente Acompanhada</span
                    >
                </div>
            </div>
            <div class="flex items-center gap-0.5 text-yellow-500">
                <i class="fa-solid fa-star text-[10px]"></i>
                <i class="fa-solid fa-star text-[10px]"></i>
                <i class="fa-solid fa-star text-[10px]"></i>
                <i class="fa-solid fa-star text-[10px]"></i>
                <i class="fa-solid fa-star text-[10px]"></i>
                <span class="text-xs text-brand-text/40 ml-2 uppercase"
                    >Google Review</span
                >
            </div>
        </footer>

        <!-- Elemento de brilho sutil ao fundo -->
        <div
            class="absolute -bottom-20 -right-20 w-64 h-64 bg-brand-secondary/5 rounded-full blur-3xl group-hover:bg-brand-secondary/10 transition-colors duration-1000"
        >
        </div>
    </blockquote>
</div>

<div class="mt-20 text-center testimonial-reveal">
    <div
        class="max-w-2xl mx-auto mb-10 text-brand-text/70 leading-relaxed text-lg"
    >
        <p>
            Assim como a L.S., muitas mulheres chegam ao consultório sentindo
            que perderam o controle de suas próprias narrativas. A análise não é
            apenas sobre falar, é sobre <span
                class="font-bold text-brand-primary">se encontrar</span
            > no meio do ruído.
        </p>
    </div>

    <p class="text-2xl text-brand-primary mb-8 font-serif italic">
        Você também pode viver essa transformação.
    </p>
    <a
        href="https://wa.me/5511973454557?text=Olá Ana! Vi o depoimento da L.S. e gostaria de entender como funciona o processo de análise."
        target="_blank"
        class="btn-primary inline-block px-12 py-5 text-lg shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all duration-300"
    >
        Iniciar minha metamorfose
    </a>
    <p class="mt-6 text-xs text-brand-text/60 uppercase tracking-tighter">
        Depoimento autorizado pela paciente.
    </p>
</div>

<style>
    #depoimentos {
        background: radial-gradient(
            circle at center,
            rgba(245, 239, 235, 1) 0%,
            rgba(245, 239, 235, 0.5) 100%
        );
    }

    .testimonial-pilar {
        max-width: 900px;
        margin: 0 auto;
        /* Removido 'all' para evitar conflito com GSAP */
        transition:
            transform 0.6s cubic-bezier(0.16, 1, 0.3, 1),
            box-shadow 0.6s cubic-bezier(0.16, 1, 0.3, 1),
            background-color 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        will-change: transform, opacity;
    }

    .testimonial-pilar:hover {
        transform: scale(1.02) !important;
        box-shadow: 0 40px 80px -20px rgba(140, 115, 85, 0.15);
    }

    :global(.testimonial-butterfly) {
        position: absolute;
        width: 25px;
        height: 25px;
        pointer-events: none;
        z-index: 1;
        opacity: 0;
    }

    :global(.butterfly-wing) {
        position: absolute;
        width: 50%;
        height: 80%;
        background-color: var(--color-brand-primary);
        border-radius: 50% 50% 50% 50% / 40% 40% 60% 60%;
    }

    :global(.butterfly-wing.left) {
        left: 0;
        transform-origin: right center;
        animation: flap-left 0.4s ease-in-out infinite alternate;
    }

    :global(.butterfly-wing.right) {
        right: 0;
        transform-origin: left center;
        animation: flap-right 0.4s ease-in-out infinite alternate;
    }

    /* Animação de flutuação lenta central */
    .animate-float-slow {
        animation: float-slow 4s ease-in-out infinite;
    }

    @keyframes float-slow {
        0%,
        100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-8px);
        }
    }

    /* Animação das "Asas" sincronizada com o corpo (flor) */
    .animate-wing-left {
        transform-box: view-box;
        transform-origin: 140px 60px;
        animation: wing-left-beat 4s ease-in-out infinite;
    }

    .animate-wing-right {
        transform-box: view-box;
        transform-origin: 140px 60px;
        animation: wing-right-beat 4s ease-in-out infinite;
    }

    @keyframes wing-left-beat {
        0%,
        100% {
            transform: rotate(0deg) translateY(0);
        }
        45% {
            transform: rotate(-15deg) translateY(-8px);
        } /* Impulso: sobe as pontas com a flor */
        75% {
            transform: rotate(3deg) translateY(-2px);
        } /* Relaxamento: desce as pontas na descida */
    }

    @keyframes wing-right-beat {
        0%,
        100% {
            transform: rotate(0deg) translateY(0);
        }
        45% {
            transform: rotate(15deg) translateY(-8px);
        } /* Impulso: sobe as pontas com a flor */
        75% {
            transform: rotate(-3deg) translateY(-2px);
        } /* Relaxamento: desce as pontas na descida */
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    const initTestimonialsAnimation = () => {
        const section = document.querySelector("#depoimentos");
        const pilar = document.querySelector(".testimonial-pilar");
        const reveals = document.querySelectorAll(".testimonial-reveal");
        const butterflyContainer = document.getElementById(
            "testimonials-butterfly-container",
        );

        if (!section || !pilar) return;

        // Limpar timelines e tweens anteriores
        gsap.killTweensOf([pilar, ...Array.from(reveals)]);

        // 1. Animação de Entrada
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: section,
                start: "top 75%",
                toggleActions: "play none none none",
                once: true,
            },
        });

        tl.fromTo(
            reveals,
            { y: 30, opacity: 0 },
            {
                y: 0,
                opacity: 1,
                duration: 0.8,
                stagger: 0.15,
                ease: "power2.out",
            },
        ).fromTo(
            pilar,
            { y: 50, opacity: 0, scale: 0.98 },
            {
                y: 0,
                opacity: 1,
                scale: 1,
                duration: 1,
                ease: "power3.out",
                clearProps: "transform,opacity",
            },
            "-=0.4",
        );

        // 2. Borboletas
        if (butterflyContainer && butterflyContainer.children.length === 0) {
            const butterflyCount = 15;
            for (let i = 0; i < butterflyCount; i++) {
                const b = document.createElement("div");
                b.className = "testimonial-butterfly";
                b.innerHTML =
                    '<div class="butterfly-wing left"></div><div class="butterfly-wing right"></div>';

                const startX = Math.random() * window.innerWidth;
                const startY = Math.random() * (section.clientHeight || 800);

                gsap.set(b, {
                    x: startX,
                    y: startY,
                    scale: 0.4 + Math.random() * 0.8,
                    rotation: Math.random() * 360,
                });

                butterflyContainer.appendChild(b);
                gsap.to(b, {
                    opacity: 0.1 + Math.random() * 0.15,
                    duration: 2,
                });
                animateButterfly(b);
            }
        }
    };

    const animateButterfly = (el: HTMLElement) => {
        gsap.to(el, {
            x: `+=${Math.random() * 400 - 200}`,
            y: `+=${Math.random() * 300 - 150}`,
            rotation: `+=${Math.random() * 90 - 45}`,
            duration: 10 + Math.random() * 10,
            ease: "sine.inOut",
            onComplete: () => animateButterfly(el),
        });

        gsap.to(el, {
            opacity: 0.25,
            duration: 2 + Math.random(),
            repeat: -1,
            yoyo: true,
            ease: "power1.inOut",
        });
    };

    initTestimonialsAnimation();
    document.addEventListener("astro:after-swap", () => {
        ScrollTrigger.refresh();
        initTestimonialsAnimation();
    });
</script>

<script type="application/ld+json" is:inline>
    {
        "@context": "https://schema.org",
        "@type": "Review",
        "itemReviewed": {
            "@type": "LocalBusiness",
            "name": "Ana Bottesi - Psicanalise Online",
            "image": "https://anabottesi.com.br/og-image.jpg"
        },
        "reviewRating": {
            "@type": "Rating",
            "ratingValue": "5",
            "bestRating": "5"
        },
        "author": {
            "@type": "Person",
            "name": "L.S."
        },
        "reviewBody": "O trabalho da Ana salvou minha vida. Cheguei ao consultório no meu limite, sem conseguir enxergar uma saída para a exaustão e a ansiedade que me consumiam."
    }
</script>
