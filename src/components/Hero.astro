---
import { Image } from "astro:assets";
import anaPortrait from "../assets/profissional/anaBottesi1.svg";
---

<section
    class="relative min-h-screen flex items-center pt-20 overflow-hidden bg-brand-bg"
>
    <!-- Elementos de Fundo -->
    <div
        class="absolute top-0 right-0 w-1/3 h-full bg-brand-secondary/5 -skew-x-12 transform origin-top-right"
    >
    </div>
    <div
        class="absolute -bottom-24 -left-24 w-64 h-64 bg-brand-primary/10 rounded-full blur-3xl"
    >
    </div>

    <!-- Efeito de Borboletas no Hero -->
    <div
        class="absolute inset-0 pointer-events-none overflow-hidden"
        id="hero-butterfly-container"
    >
    </div>

    <div
        class="section-padding relative z-10 grid md:grid-cols-2 gap-12 items-center"
    >
        <div id="hero-content">
            <div
                class="inline-flex items-center gap-2 px-3 py-1 bg-brand-secondary/20 text-brand-accent rounded-full text-xs font-semibold mb-6 uppercase tracking-wider"
            >
                <i class="fa-solid fa-sparkles text-brand-secondary"></i> Psicanálise
                para mulheres
            </div>

            <h1 class="text-5xl md:text-7xl font-bold leading-tight mb-6">
                Um espaço de escuta para a sua <span
                    class="text-brand-primary italic">metamorfose</span
                >.
            </h1>

            <p
                class="text-xl text-brand-text/80 mb-4 max-w-lg leading-relaxed font-serif italic"
            >
                Olá, eu sou a Ana. E se a gente conversasse sem pressa?
            </p>
            <p
                class="text-base text-brand-text/60 mb-8 max-w-lg leading-relaxed"
            >
                Atendimento online para mulheres, em toda a sua diversidade.
            </p>

            <div class="flex flex-wrap gap-3 mb-10">
                <span
                    class="px-4 py-2 bg-white border border-brand-primary/20 rounded-lg text-sm font-medium text-brand-accent shadow-sm"
                >
                    Relações abusivas
                </span>
                <span
                    class="px-4 py-2 bg-white border border-brand-primary/20 rounded-lg text-sm font-medium text-brand-accent shadow-sm"
                >
                    Exaustão
                </span>
                <span
                    class="px-4 py-2 bg-white border border-brand-primary/20 rounded-lg text-sm font-medium text-brand-accent shadow-sm"
                >
                    Dependência emocional
                </span>
            </div>

            <div class="flex flex-col sm:flex-row gap-4">
                <a
                    href="https://wa.me/5511973454557?text=Olá Ana! Vi seu site e gostaria de agendar uma consulta."
                    class="btn-primary"
                    target="_blank"
                >
                    Agende uma sessão
                </a>
                <a href="#sobre" class="btn-secondary"> Vamos conversar? </a>
            </div>

            <div class="mt-8 flex items-center gap-3"></div>
        </div>

        <div class="relative" id="hero-image">
            <div
                class="absolute inset-0 bg-brand-primary/10 rounded-2xl rotate-3 transform"
            >
            </div>
            <div
                class="relative bg-white rounded-2xl overflow-hidden shadow-2xl border-8 border-white"
            >
                <Image
                    src={anaPortrait}
                    alt="Ana Bottesi"
                    class="w-full h-auto rounded-xl"
                    loading="eager"
                />
            </div>

            <!-- Card Flutuante de Destaque -->
            <div
                class="absolute -bottom-6 -left-6 glass p-6 rounded-xl shadow-xl max-w-[200px]"
                id="hero-floating-card"
            >
                <p class="text-brand-primary font-bold text-3xl mb-1">95%</p>
                <p
                    class="text-xs text-brand-text/70 uppercase tracking-tighter font-semibold"
                >
                    Nota de satisfação das pacientes
                </p>
            </div>
        </div>
    </div>
</section>

<style>
    /* Otimização de LCP: Animação em CSS Puro para evitar atraso do JS */
    #hero-content {
        animation: heroFadeInUp 1s ease-out forwards;
        opacity: 0;
    }

    @keyframes heroFadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Estilos para as borboletas voadoras */
    :global(.hero-butterfly) {
        position: absolute;
        width: 25px;
        height: 25px;
        pointer-events: none;
        z-index: 5;
        opacity: 0.15;
    }

    :global(.butterfly-wing) {
        position: absolute;
        width: 50%;
        height: 80%;
        background-color: var(--color-brand-primary);
        border-radius: 50% 50% 50% 50% / 40% 40% 60% 60%;
    }

    :global(.butterfly-wing.left) {
        left: 0;
        transform-origin: right center;
        animation: flap-left 0.4s ease-in-out infinite alternate;
    }

    :global(.butterfly-wing.right) {
        right: 0;
        transform-origin: left center;
        animation: flap-right 0.4s ease-in-out infinite alternate;
    }

    @keyframes flap-left {
        from {
            transform: rotateY(0deg);
        }
        to {
            transform: rotateY(70deg);
        }
    }

    @keyframes flap-right {
        from {
            transform: rotateY(0deg);
        }
        to {
            transform: rotateY(-70deg);
        }
    }
</style>

<script>
    import { gsap } from "gsap";

    const initHeroAnimation = () => {
        // Reduzimos o escopo do GSAP no Hero para não afetar o LCP (H1)
        const tl = gsap.timeline({
            defaults: { ease: "power4.out" },
            delay: 0.2, // Pequeno delay para garantir que o CSS já iniciou
        });

        tl.from("#hero-image", {
            x: 50,
            opacity: 0,
            duration: 1.2,
        }).from(
            "#hero-floating-card",
            {
                scale: 0,
                opacity: 0,
                duration: 0.8,
            },
            "-=0.6",
        );

        // Inicia efeito de borboletas de forma secundária
        createButterflies();
    };

    const createButterflies = () => {
        const container = document.getElementById("hero-butterfly-container");
        if (!container) return;

        const count = 10;
        for (let i = 0; i < count; i++) {
            const butterfly = document.createElement("div");
            butterfly.className = "hero-butterfly";
            butterfly.innerHTML = `
                <div class="butterfly-wing left"></div>
                <div class="butterfly-wing right"></div>
            `;

            const startX = Math.random() * window.innerWidth;
            const startY = Math.random() * window.innerHeight;

            gsap.set(butterfly, {
                x: startX,
                y: startY,
                scale: 0.4 + Math.random() * 0.6,
                rotation: Math.random() * 360,
            });

            container.appendChild(butterfly);
            animateButterfly(butterfly);
        }
    };

    const animateButterfly = (el: HTMLElement) => {
        gsap.to(el, {
            x: `+=${Math.random() * 400 - 200}`,
            y: `+=${Math.random() * 400 - 200}`,
            rotation: `+=${Math.random() * 90 - 45}`,
            duration: 6 + Math.random() * 6,
            ease: "sine.inOut",
            onComplete: () => animateButterfly(el),
        });

        gsap.to(el, {
            opacity: 0.2,
            duration: 2,
            repeat: -1,
            yoyo: true,
        });
    };

    // Garantimos que a execução não bloqueie o carregamento crítico
    if (document.readyState === "complete") {
        initHeroAnimation();
    } else {
        window.addEventListener("load", initHeroAnimation);
    }
</script>
